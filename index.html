<!DOCTYPE html>
<html>
<head>
  <title>Kairo Task Submit</title>
</head>
<body>
  <h2>Submit a Task to Kairo</h2>
  <input type="text" id="task-input" placeholder="Enter task ID..." />
  <button onclick="submitTask()">Submit Task</button>

  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>
  <script>
    // ✅ Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDmLHI1qAd-FAAGG3pzNvc4MgWDC7pozGU",
      authDomain: "dish-dialogue-kairo-f54e2.firebaseapp.com",
      projectId: "dish-dialogue-kairo-f54e2",
      storageBucket: "dish-dialogue-kairo-f54e2.firebasestorage.app",
      messagingSenderId: "733841485241",
      appId: "1:733841485241:web:292aee1cd489cd67729a68"
    };

    // ✅ Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ✅ Submit Task to Firestore
    async function submitTask() {
      const input = document.getElementById("task-input").value.trim();
      if (!input) {
        alert("❌ Please enter a task ID.");
        return;
      }

      const task = {
        id: input,
        type: "test-trigger",
        description: "Manual task to verify processor function",
        status: "pending",
        created_at: firebase.firestore.FieldValue.serverTimestamp(),
        details: {
          initiated_by: "manual",
          purpose: "test"
        }
      };

      try {
        await db.collection("task_queue").add(task);
        alert(`✅ Task "${input}" submitted to Firestore.`);
        console.log("Task added:", task);
      } catch (e) {
        console.error("❌ Error writing to Firestore:", e);
        alert("❌ Failed to submit task.");
      }
    }
  </script>
</body>
</html>
